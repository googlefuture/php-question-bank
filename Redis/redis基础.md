# redis基础知识汇总

## Redis支持的数据类型？

String字符串、Hash（哈希）、List（列表）、Set（集合）、zset(sorted set：有序集合)


## Redis连接时的connect与pconnect的区别

connect：脚本结束之后连接就释放了。

pconnect：脚本结束之后连接不释放，连接保持在php-fpm进程中。每个php-fpm进程占用一哥连接，当php-fpm进程结束时会释放掉
所以使用pconnect代替connect，可以减少频繁建立redis连接的消耗。


## 使用过Redis分布式锁么，它是怎么实现的？
先拿setnx来争抢锁，抢到之后，再用expire给锁加一个过期时间防止锁忘记了释放。

## Redis 与 Memcache 区别

|对比项|Redis|Memcache|
|-----|-----|-----|
|数据结构|丰富数据类型|只支持简单 KV 数据类型|
|数据一致性|事务|cas|
|持久性|快照/AOF|不支持|
|网络IO|单线程 IO 复用|多线程、非阻塞 IO 复用|
|内存管理机制|现场申请内存|预分配内存|

## 为什么 Redis 是单线程的

Redis 是基于内存的操作，CPU 不是 Redis 的瓶颈，Redis 瓶颈最有可能是内存或网络。而且单线程容易实现，避免了不必要的上下文切换和竞争条件，不存在多线程切换消耗 CPU

## 各个数据类型应用场景：

|类型	|简介	|特性	|场景 |
|-------|-------|-------| --- |
|String(字符串)|二进制安全|可以包含任何数据,比如jpg图片或者序列化的对象,一个键最大能存储512M |	--- |
|Hash(字典)	|键值对集合,即编程语言中的Map类型|适合存储对象,并且可以像数据库中update一个属性一样只修改某一项属性值(Memcached中需要取出整个字符串反序列化成对象修改完再序列化存回去)	|存储、读取、修改用户属性|
|List(列表)	|链表(双向链表)	|增删快,提供了操作某一段元素的API | 1,最新消息排行等功能(比如朋友圈的时间线) 2,消息队列|
|Set(集合)	|哈希表实现,元素不重复	|1、添加、删除,查找的复杂度都是O(1) 2、为集合提供了求交集、并集、差集等操作	|1、共同好友 2、利用唯一性,统计访问网站的所有独立ip 3、好友推荐时,根据tag求交集,大于某个阈值就可以推荐|
|Sorted Set(有序集合)|将Set中的元素增加一个权重参数score,元素按score有序排列|	数据插入集合时,已经进行天然排序 | 1、排行榜 2、带权重的消息队列|