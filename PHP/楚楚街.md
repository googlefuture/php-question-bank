## 北京醋溜网络科技有限公司（楚楚街）
### 2018-09面试题

> 以下答案仅供参考，答案不断完善中~~~

##### 1.简述 echo 0 == 'a1' ? 1 : 2的输出结果，为什么会出现这种情况？

```php
1
比较时PHP会自动把字符串转换为整型，字符串a的开头不包含任何数字，所以会被转为0
```

##### 2. $a=1; $b=&$a; $c=2; $a=&$c; $c=2; $a=?,$b=?,$c=?

```php
2
1
2
```

##### 3. $a = true or false; $a=?

```php
1
```
解析见：[php.net](https://www.php.net/manual/zh/language.operators.logical.php)

##### 4. 请写出防止XSS攻击的函数，CSRF怎么样预防

```text
1.服务端进行CSRF防御
服务端的CSRF方式方法很多样，但总的思想都是一致的，就是在客户端页面增加伪随机数。
(1).Cookie Hashing(所有表单都包含同一个伪随机值)：
这可能是最简单的解决方案了，因为攻击者不能获得第三方的Cookie(理论上)，所以表单中的数据也就构造失败了
(2).验证码
　　这个方案的思路是：每次的用户提交都需要用户在表单中填写一个图片上的随机字符串，厄....这个方案可以完全解决CSRF，但个人觉得在易用性方面似乎不是太好，还有听闻是验证码图片的使用涉及了一个被称为MHTML的Bug，可能在某些版本的微软IE中受影响。
(3).One-Time Tokens(不同的表单包含一个不同的伪随机值)
　　在实现One-Time Tokens时，需要注意一点：就是“并行会话的兼容”。如果用户在一个站点上同时打开了两个不同的表单，CSRF保护措施不应该影响到他对任何表单的提交。考虑一下如果每次表单被装入时站点生成一个伪随机值来覆盖以前的伪随机值将会发生什么情况：用户只能成功地提交他最后打开的表单，因为所有其他的表单都含有非法的伪随机值。必须小心操作以确保CSRF保护措施不会影响选项卡式的浏览或者利用多个浏览器窗口浏览一个站点。

2.预防xss攻击
php防止XSS跨站脚本攻击的方法:是针对非法的HTML代码包括单双引号等，使用htmlspecialchars()函数 。
在使用htmlspecialchars()函数的时候注意第二个参数, 直接用htmlspecialchars($string) 的话,第二个参数默认是ENT_COMPAT,函数默认只是转化双引号(“), 不对单引号(‘)做转义
```

##### 5. 如何实现字符串翻转？要求时间复杂度小于O(n) (只可以用函数strlen)

```php

$str = "ABCDEFG";
 
//** 使用strlen()函数 */
function way2($str){
    $len = strlen($str);
    $new_str = '';
    while( $len ){
        $new_str .= $str[$len-1];
        $len --;
    }
    return $new_str;
}

```

##### 6.请写出你所知的排序算法并表明时间复杂度，然后实现你认为最高效的算法

```php

```

##### 7. JS实现简单的手机号码验证

```javascript
function isPhone(phone) {
    var myreg=/^[1][3,4,5,6,7,8,9][0-9]{9}$/;
    if (!myreg.test(phone)) {
        return false;
    } else {
        return true;
    }
}
```

##### 8. console.log(0.17 * 10 == 1.7)的结果?

```php
false
JS中数字运算时，有一个叫做 数字运算中的精度缺失的问题
0.17 * 10 也许等于1.7000000000000001
```

##### 9.请写出下列http状态码的含义

```php
304:如果客户端发送了一个带条件的GET 请求且该请求已被允许，而文档的内容（自上次访问以来或者根据请求的条件）并没有改变，则服务器应当返回这个304状态码。简单的表达就是：服务端已经执行了GET，但文件未变化。

403:是一种在网站访问过程中，常见的错误提示，表示资源不可用。服务器理解客户的请求，但拒绝处理它，通常由于服务器上文件或目录的权限设置导致的WEB访问错误。
429:当你需要限制客户端请求某个服务的数量，也就是限制请求速度时，该状态码就会非常有用。在此之前，有一些类似的状态码。例如“509 Bandwidth Limit Exceeded”
503:503是一种HTTP状态码。英文名503 Service Unavailable与404（404 Not Found)是同属一种网页状态出错码。前者是服务器出错的一种返回状态，后者是网页程序没有相关的结果后返回的一种状态，需要优化网站的时候通常需要制作404出错页以便网站整体优化。
```

##### 10. 统计一个字符串在文件中出现的次数，用系统命令实现


```php
//在文件index.php中统计hello出现的次数:
grep -o hello index.php | wc -l

grep 命令

grep -o 字符串 文件名 
-o, –only-matching 
Show only the part of a matching line that matches PATTERN. 即“仅匹配”之意。 返回匹配到的字符串

wc命令

1.命令格式： 
wc [选项]文件… 
2.命令功能： 
统计指定文件中的字节数、字数、行数，并将统计结果显示输出。该命令统计指定文件中的字节数、字数、行数。如果没有给出文件名，则从标准输入读取。wc同时也给出所指定文件的总统计数。 
3.命令参数： 
-c 统计字节数。 
-l 统计行数。 
-m 统计字符数。这个标志不能与 -c 标志一起使用。 
-w 统计字数。一个字被定义为由空白、跳格或换行字符分隔的字符串。 
-L 打印最长行的长度。 
–help 显示帮助信息 
–version 显示版本信息
```


##### 11.文件权限644、755分别代表什么意思

```php
第一个数字 表示文件所有者的权限 
第二个数字 表示与文件所有者同属一个用户组的其他用户的权限 
第三个数字 表示其它用户组的权限

权限分为三种： 读（r=4），写（w=2），执行（x=1）。

权限755：
      755：（4+2+1）（4+1）（4+1）

      第一个7：表示当前文件的拥有者的权限 7 = 4+2+1 可读可写可执行权限

      第二个5：表示当前文件的所属组（同组用户）权限5 = 4+1 可读可执行权限

      第三个5：表示当前文件的组外权限5 = 4+1 可读可执行权限

权限644：
      644：（4+2）（4）（4）

      第一个6：表示当前文件的拥有者的权限 7 = 4+2 可读可写权限

      第二个4：表示当前文件的所属组（同组用户）权限4= 4 可读权限

      第三个4：表示当前文件的组外权限4 = 4 可读权限
```

##### 12. nginx将所有到/api/xxx的请求重写到/api.php/xxx

```php

```


##### 13. 有result表如下：(结构如下，每个学生会有多门成绩，数据只为实例)

| name  | subject| score |
|------ |:------:| ----- |
| 张三   |  数学   | 80   |
| 小明   |  语文   | 63   |
| 小刚   |  英语   | 59   |
。。。还有很多数据。。。

(1).只用一个select语句查询：不及格科目大于或等于 2科的学生，所有科目的平均分
```php

```

(2).还是上面的表，查询每个学生的最大分数的科目及分数
```php

```

##### 14.数据表建立复合索引tab_index('name','age'),下面哪些语句能用上索引？(多选) ( 2、3 )

```mysql
1. select * form table where age = 18 and name = 'test';
2. select * form table where name = 'test' and age = 18;
3. select * form table where name like 'test%' and age = 18;
4. select * form table where name like '%test' and age = 18;
```

```
索引失效的几种情况
  　　1.如果条件中有or，即使其中有条件带索引也不会使用(这也是为什么尽量少用or的原因)
  　　要想使用or，又想让索引生效，只能将or条件中的每个列都加上索引
  　　2.对于多列索引，不是使用的第一部分，则不会使用索引
  　　3.like查询以%开头
  　　4.如果列类型是字符串，那一定要在条件中将数据使用引号引用起来,否则不使用索引
  　　5.如果mysql估计使用全表扫描要比使用索引快,则不使用索引
解析：
     1 没有注意复合索引顺序
     2 正确 
     3 正确 
     4 凡是对索引列，使用了‘%XXX’，都不走索引
```
